const MIN_RAD=1,MAX_RAD=2,MIN_VISUAL=24,MAX_VISUAL=72,MIN_RAD2=.65,MAX_RAD2=3.1,MIN_VISUAL2=72,MAX_VISUAL2=256,MIN_ORBIT=1,MAX_ORBIT=1e3,PARSEC_LIGHTYEAR=3.26156378,SOL_MAG=4.83,POGSON=-2.5,FLUX_INNER=1.1,FLUX_OUTTER=.53,SPECTRAL_TYPES=["B","A","F","G","K","M"],SPECTRAL_BC=[-2,-.3,-.15,-.4,-.8,-2],LIMIT=26832,EMPTY_VALUE="EMPTY",BASE_URL="/projects/exoplanets/",SEARCH_TYPES=["pl_name","hostname","disc_year"],DEFAULT_MAX_RESULTS=15;let VALUES=[],DATA=[],LAST_DATA_KEY="",LAST_QUERY="",LAST_SEARCHTYPE="",MORE_RESULTS=0;function get(t,e){const i=VALUES.indexOf(t);return-1!==i&&""!==e[i]?e[i]:EMPTY_VALUE}function getListItemDataHTML(t,e){return'<span><span class="list-value-label">'+t+":</span> "+e+"</span>"}function getListItemHTML(t){const e=get("rowid",t),i=get("pl_name",t),n=get("disc_year",t);let a=get("sy_dist",t);return a=(a*=PARSEC_LIGHTYEAR).toFixed(2),'<div class="list-item" id="'+e+'"><div class="left"><div class="visual"></div></div><div class="right"><span class="title">'+i+"</span>"+getListItemDataHTML("Found in",n)+getListItemDataHTML("Distance",a+" ly")+"</div></div>"}function getMainDetailLabelHTML(t){return'<span class="value-label">'+t+":</span>"}function getMainDetailValueHTML(t){return"<span>"+t+"</span>"}function hsvToRgb(t,e,i){let n,a,s,l,o,c,r,d;switch(c=i*(1-e),r=i*(1-(o=6*t-(l=Math.floor(6*t)))*e),d=i*(1-(1-o)*e),l%6){case 0:n=i,a=d,s=c;break;case 1:n=r,a=i,s=c;break;case 2:n=c,a=i,s=d;break;case 3:n=c,a=r,s=i;break;case 4:n=d,a=c,s=i;break;case 5:n=i,a=c,s=r;break;default:n=1,a=1,s=1}return"rgb("+Math.round(255*n)+", "+Math.round(255*a)+", "+Math.round(255*s)+")"}function getURLParameter(t){const e=new URLSearchParams(window.location.search);return e.has(t)?e.get(t):""}function getHabitableZone(t){const e=get("gaia_gmag",t),i=get("st_optmag",t);let n;if(e===EMPTY_VALUE&&i===EMPTY_VALUE)return[0,0];e!==EMPTY_VALUE&&i===EMPTY_VALUE?n=e:e===EMPTY_VALUE&&i!==EMPTY_VALUE&&(n=i);let a=get("sy_dist",t);const s=get("st_spstr",t).substring(0,1),l=SPECTRAL_TYPES.indexOf(s);let o=n-5*Math.log(a)+(-1!==l?SPECTRAL_BC[l]:-2),c=Math.pow(10,(o-SOL_MAG)/POGSON);return[Math.sqrt(c/FLUX_INNER).toFixed(2),Math.sqrt(c/FLUX_OUTTER).toFixed(2)]}function scaled(t,e,i,n,a){return t<e?t=e:t>i&&(t=i),n+(a-n)*(t-e)/(i-e)}function setVisual(t,e,i,n,a,s){let l=get("pl_rade",t),o=get("pl_orbper",t);o>MAX_ORBIT?o=MAX_ORBIT:o<MIN_ORBIT&&(o=MIN_ORBIT);const c=hsvToRgb(scaled(o,MIN_ORBIT,MAX_ORBIT,0,360),.7,.95);l===EMPTY_VALUE?l=i+(n-i)/2:l>n?l=n:l<i&&(l=i);const r=Math.round(scaled(l,i,n,a,s));e.css("width",r+"px"),e.css("height",r+"px"),e.css("background-color",c)}function list_readyResults(){$("div.list-container > span.list-start").hide(),$("div.list-container > span.list-none").hide(),$("div.list-container").removeClass("list-container-empty"),$("div.list-container > div.list-item").off(),$("div.list-container > div.list-item").remove()}function list_noResults(){$("div.list-container > div.list-item").remove(),$("div.list-container").addClass("list-container-empty"),$("div.list-container > span.list-none").show(),$("div.list-container > span.list-start").hide()}function exoKeyUp(t){13===(t.keyCode||t.which)&&(MORE_RESULTS=0,exoDoQuery($("input.exo-search").val()))}function exoDoQuery(t){const e=$("select.exo-search-type").val();let i=SEARCH_TYPES.includes(e);if(!i)return void alert('There was a problem with validating the search type! ("'+e+'")');if(i=!1,""===t)return;const n=t.toLowerCase();t.includes(" ")&&(t=t.replace(/\s/g,"")),t.includes("-")&&(t=t.replace(/-/g,"")),t.includes("+")&&(t=t.replace(/\+/g,"")),!1!==/^[a-z0-9]+$/i.test(t)?exoSearch(n,e):alert('Invalid query! (can only include letters, numbers, spaces or "+" and "-")')}function exoSearch(t,e){let i=1,n="hoststar";e===SEARCH_TYPES[2]&&(i=4,n="year");let a=t.substring(0,i);LAST_DATA_KEY===a?exoRunSearch(t,e):(LAST_DATA_KEY=a,$.getJSON("/resources/json/aXoUztUmqZpBb8pz/exoplanets-index/"+n+"/"+a+".json?callback=?",function(i){DATA=i,exoRunSearch(t,e)}).fail(function(){list_noResults()}))}function exoRunSearch(t,e){let i=!1,n=0,a=!0;const s=$("div.list-container");$.each(DATA,function(l,o){if(n!==DEFAULT_MAX_RESULTS+DEFAULT_MAX_RESULTS*MORE_RESULTS){if(String(get(e,o)).toLowerCase().includes(t)){i||(list_readyResults(),i=!0),s.append(getListItemHTML(o));const t=get("rowid",o);setVisual(o,$("div.list-item#"+t+" > div.left > div.visual"),MIN_RAD,MAX_RAD,MIN_VISUAL,MAX_VISUAL),n++}}else a=!1}),i?exoRegisterListItemClicks():list_noResults();let l=$("button#more-results");a?l.hide():l.show(),LAST_QUERY=t,LAST_SEARCHTYPE=e}function exoMoreResults(){MORE_RESULTS++,exoRunSearch(LAST_QUERY,LAST_SEARCHTYPE)}function exoRegisterListItemClicks(){$("div.list-container > div.list-item").each(function(){const t=$(this).attr("id");$("div.list-container > div.list-item#"+t).on("click",function(){listItemClick(t)})})}function listItemClick(t){window.location=BASE_URL+"?id="+String(t)}function outputMainDetail(t,e){t=t.toString(),$("div.main-details-container div.main-details-labels").append(getMainDetailLabelHTML(e)),$("div.main-details-container div.main-details-values").append(getMainDetailValueHTML(t.includes(EMPTY_VALUE)?'<span style="color:grey">Unknown</span>':t))}function outputAllDetails(t){let e=$("div.all-data-container div.all-data-labels"),i=$("div.all-data-container div.all-data-values");for(let n of VALUES){e.append(getMainDetailLabelHTML(n));const a=get(n,t);i.append(getMainDetailValueHTML(a.includes(EMPTY_VALUE)?'<span style="color:grey">Unknown</span>':a))}}function go_details(t){$("div.exo-container#search").hide(),$("div.exo-container#details").show();let e=[];for(let i of DATA)if(get("rowid",i)===t){e=i;break}const i=get("pl_name",e);$("title").html(i),$("div.main-card-text > h1").html(i),outputMainDetail(get("sy_dist",e)*PARSEC_LIGHTYEAR,"Distance (ly)"),outputMainDetail(get("pl_orbper",e),"Orbit (days)"),outputMainDetail(get("pl_masse",e),"Mass (Earth)"),outputMainDetail(get("pl_rade",e),"Radius (Earth)"),outputMainDetail(get("pl_orbeccen",e),"Eccentricity"),outputMainDetail(get("disc_year",e)+" ("+get("discoverymethod",e)+")","Discovered"),setVisual(e,$("div.main-card > div.main-card-visual"),MIN_RAD2,MAX_RAD2,MIN_VISUAL2,MAX_VISUAL2),outputAllDetails(e),$("button#all-data-toggle").on("click",function(){let t=$("div.all-data-container");t.is(":visible")?($(this).html("Show"),t.hide()):($(this).html("Hide"),t.show())}),$("button#go-back").on("click",function(){window.location=BASE_URL})}function exoGo(){const t=getURLParameter("id");if(/[0-9]/.test(t)&&parseFloat(t)<=LIMIT&&parseFloat(t)>=1)$.getJSON("/resources/json/aXoUztUmqZpBb8pz/exoplanets-index/id/"+Math.floor(t/1e3)+".json?callback=?",function(e){DATA=e,go_details(t)});else{""!==t&&alert("Invalid ID (must be between 1 and "+LIMIT+")"),$("button#more-results").on("click",function(){exoMoreResults()})}}$(document).ready(function(){$.getJSON("/resources/json/aXoUztUmqZpBb8pz/exoplanets-values.json?callback=?",function(t){VALUES=t,exoGo()})});